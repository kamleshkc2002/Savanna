<script type="text/javascript" src="state_countryjs.asp"></script>
<style>
.overlay {
  /*background-image: url(assets/templates/common/images/transparent.png);*/
    background-color: #fff;
  filter:alpha(opacity=80); /* Transparency */
  opacity:0.8;  /* Transparency */
}
#overlay {
  background-image: url(assets/templates/common/images/transparent.png);
}
* html #overlay {
  background-image: url(assets/templates/common/images/pixel_trans.gif);
 filter: progid:DXImageTransform.Microsoft.AlphaImageLoader(src="assets/templates/common/images/transparent.png", sizingMethod="scale");
}
#simplemodal-overlay {background-color:#000;}
</style>

<script type="text/javascript">
  var scity="";
  var szip="";
  var scountry="";
  var sstate = "";
  var saddress="";
  var addrchange="";
  var ajax_request_progress=0;
  var selectedShipId=0;
  var useAddressValidator = "[useAddressValidator]";
  var validShippingAddress = 0;
  var lastShippingAddress = "";

  if (typeof jQuery == 'undefined') {
      document.write("<script type=\"text/javascript\" src=\"assets/templates/common/js/jquery.min.js\"></" + "script>");
  }


  function get_Element(i)
  {
    return document.getElementById(i) || document.getElementsByName(i).item(0);
  } 

  function addressValidatorContinue(type)
  {
      jQuery.modal.close();
      remove_overlay("billing_info");
      if (get_Element('sameAsBilling') != 'undefined' && get_Element('sameAsBilling') != null){
          var sameAsBilling = get_Element('sameAsBilling').checked;}
      else{
          var sameAsBilling = true;}
      if (!sameAsBilling)
          remove_overlay("shipping_info");
      validShippingAddress = 1;
      check_address(type);
  }

  function check_address2_pos(type)
  {
      if (jQuery("#hdnAddrressValidatorResult").val() == "1")
      {
          jQuery.modal.close();
          validShippingAddress = 1;
          check_address(type);
      }
      else
      {
          validShippingAddress = 0;
          jQuery("#divAddrressValidator").modal({containerCss:{borderWidth:"1px"}});
      }  
  }

  function closeAddressValidatorModal()
  {
      parent.jQuery.modal.close();
      if (get_Element('sameAsBilling') != 'undefined' && get_Element('sameAsBilling') != null){
          var sameAsBilling = get_Element('sameAsBilling').checked;}
      else{
          var sameAsBilling = true;}
      if (!sameAsBilling)
          remove_overlay("shipping_info");
  }

  function select_shipping(shipid)
  {
      selectedShipId = shipid;
      add_overlay("total_div",1);
      add_overlay("divPayment", 1);
  
      var url = 'ship_ajax.asp?action1=total&no-cache='+Math.random();
      var params = 'id=' + shipid + '&action=total';

      jQuery.ajax({
          url: url,
          dataType: 'html',
          type: 'POST',
          data: params,
          cache: false,
          success: function (strResult) {
              jQuery("#total_div").html(strResult);
          },
          complete: updateajax_total,
          error: reportError
      });
  }


      function doPayment()
      { 
          var params = '';

          add_overlay("divPayment", 1);
          var url = 'checkout_one.asp?action=dopayment';

          jQuery.ajax({
              url: url,
              dataType: 'html',
              type: 'POST',
              data: params,
              cache: false,
              success: function (strResult) {
                  jQuery("#divPayment").html(strResult);
              },
              complete: paymentSuccess,
              error: reportError
          });
      } 
  
      function paymentSuccess()
      {
          controlDivPayment('');
          remove_overlay("divPayment");
      }

      function checkoutQuestionsSuccess() {
          remove_overlay("divCheckoutQuestions");
      }
  
      function doCart()
      { 
          var params = 'action=docart';
    
          add_overlay("divCart",1);
          var url = 'checkout_one.asp';

          jQuery.ajax({
              url: url,
              dataType: 'html',
              type: 'POST',
              data: params,
              cache: false,
              success: function (strResult) {
                  jQuery("#divCart").html(strResult);
              },
              complete: cartSuccess,
              error: reportError
          });   
      } 
  
      function cartSuccess()
      {
          remove_overlay("divCart");
      }
  
      function selectAddress(AddrressValidator_address1, AddrressValidator_address2, AddrressValidator_city, AddrressValidator_state, AddrressValidator_zip, AddrressValidator_type, AddressValidator_RDI)
      {
          jQuery.modal.close();
          getElementById_s(AddrressValidator_type + "_address").value = AddrressValidator_address1;
          getElementById_s(AddrressValidator_type + "_address2").value = AddrressValidator_address2;
          getElementById_s(AddrressValidator_type + "_city").value = AddrressValidator_city;
          getElementById_s(AddrressValidator_type + "_zip").value = AddrressValidator_zip;
          getElementById_s(AddrressValidator_type + "_state").value = AddrressValidator_state;
          remove_overlay("billing_info");
          if (get_Element('sameAsBilling') != 'undefined' && get_Element('sameAsBilling') != null){
              var sameAsBilling = get_Element('sameAsBilling').checked;}
          else{
              var sameAsBilling = true;}
          if (!sameAsBilling)
            remove_overlay("shipping_info");
          if (getElementById_s("shipping_addresstype") && AddressValidator_RDI != ""){
            if (AddressValidator_RDI == "R")
              getElementById_s("shipping_addresstype").value = "1";
            else
              getElementById_s("shipping_addresstype").value = "2";
          }
          check_address(AddrressValidator_type);
      }

      function doCheckout(objForm)
      {
          setValidation();
          if (!objForm.onsubmit() || !checkotherreqfields())
              return false;

          if (validShippingAddress == 0){
              isSubmitComplete = false;
              check_address("refresh");
              return;
          }

          var params = 'action=docheckout';
          var formArray = getValuesAsArray(objForm);

          for(var prop in formArray){
              var value = formArray[prop];
              value = escape(value);
              params = params + '&' + prop + '=' + value;
          }

          if (document.eci_form != null && document.eci_form != "undefined")
          {
              params = params + '&elayawayParams=';
              var formArrayElayaway = getValuesAsArray(document.eci_form);
              for(var prop in formArrayElayaway)
              {
                  var value = formArrayElayaway[prop];
                  value = escape(value);
                  params = params + prop + '=' + value + '|';
              }
          }
     
          get_Element('divCheckout').style.display = 'block';
          add_overlay("billing_div",1);
          var url = 'checkout_one.asp';

          jQuery.ajax({
              url: url,
              dataType: 'html',
              type: 'POST',
              data: params,
              cache: false,
              success: function (strResult) {
                  jQuery("#divCheckout").html(strResult);
              },
              complete: checkoutSuccess,
              error: reportError
          });   
      } 

      function checkoutSuccess()
      {
          remove_overlay("billing_div");
    
          var divCheckout = getInnerText('divCheckout');

          if(divCheckout.indexOf('ORDER PLACED')>=0 || divCheckout.indexOf('REDIRECTING')>=0)
          {
              //var orderId = divCheckout.split("-");
              //window.location.href='ordertracking.asp?op=1&action=view&id='+orderId[1];
              //window.location.href='checkout_thankyou.asp?i=' + orderId[1] + '&t=' +orderId[2];
              return void(0);
          }
    
          isSubmitComplete = false;
    
          if(divCheckout.indexOf('INVALID_CART')>=0)
          {
              doCart();
              check_address('InvalidCart');
              alert(divCheckout.replace('INVALID_CART',''));
              return void(0);
          }
    
          if(divCheckout.indexOf('REDIRECT')>=0)
          {
              return void(0);
          }
        
          alert(divCheckout.replace('<li>','\n \- '));
        
      }

      function checkoutFailure()
      {
          remove_overlay("billing_div");
      }
  


      function getInnerText(div)
      {
          if(document.all){
              return get_Element(div).innerText;
          } else{
              return get_Element(div).textContent;
          } 
      }

      function initpage()
      {
          check_address('shipping');
    
          if (!document.billing.shipping_zip)
          {
              select_shipping(-1);
          }
          else 
          {
              if (document.billing.shipping_zip.value == '')
                  select_shipping(-1);
          }
    
          controlDivPayment('');
          fillEmailDiv();
      }

  
      function check_address(type)
      {
          isSubmitComplete = false;

          if (get_Element('sameAsBilling') != 'undefined' && get_Element('sameAsBilling') != null)
          {
              var sameAsBilling = get_Element('sameAsBilling').checked;
          }
          else
          {
              var sameAsBilling = true; 
              if (type == 'shipping')
                  type = 'billing';
          }

          if (type == '')
              if (sameAsBilling)
                  type = 'billing';
              else
                  type = 'shipping';
      
          if ((sameAsBilling && type == 'billing') || (!sameAsBilling && type == 'shipping') || (type == 'CouponApplied') || (type == 'addresstype') || (type == 'InvalidCart') || (type == 'refresh'))
              check_address2(type);
      }

      function check_address2(type) 
      {
          var overlayAdded = false;
          var type2 = type;
          if (get_Element('sameAsBilling') != 'undefined' && get_Element('sameAsBilling') != null)
              var sameAsBilling = get_Element('sameAsBilling').checked;
          else
              var sameAsBilling = true;
    
          if (type2 == 'CouponApplied' || type2 == 'InvalidCart' || type2 == 'refresh' || type2 == 'addresstype')
              if (sameAsBilling)
                  type = 'billing';
              else
                  type = 'shipping';
      
          addrchange=0;

          if (jQuery('#' + type + '_address').val() != saddress) { saddress = escape(removeHTMLTags(jQuery('#' + type + '_address').val())); addrchange = 1; }
          if (jQuery('#' + type + '_state').val() != sstate) { sstate = escape(removeHTMLTags(jQuery('#' + type + '_state').val())); addrchange = 1; }
          if (jQuery('#' + type + '_city').val() != scity) { scity = escape(removeHTMLTags(jQuery('#' + type + '_city').val())); addrchange = 1; }
          if (jQuery('#' + type + '_country').val() != scountry) { scountry = escape(removeHTMLTags(jQuery('#' + type + '_country').val())); addrchange = 1; }
          if (jQuery('#' + type + '_zip').val() != szip || jQuery('#' + type + '_country').val() != 'US') { szip = escape(removeHTMLTags(jQuery('#' + type + '_zip').val())); addrchange = 1; }

          if (type2 == 'refresh' || type2 == 'addresstype') {addrchange=1;}

          if (((szip.length >= 1 && sstate.length >= 1 && scountry.length >= 1) || (scountry != 'US' && scountry.length >= 1)) && addrchange == 1 && ajax_request_progress == 0) {
              if (get_Element('sameAsBilling') != 'undefined' && get_Element('sameAsBilling') != null)
              {
                  if (get_Element('sameAsBilling').checked)
                  {
                      sameAsBilling = 1;
                  }
                  else
                  {
                      add_overlay("shipping_info",0)
                      overlayAdded = true;
                      sameAsBilling = 0;
                  }
              }
              else
              {
                  sameAsBilling = 1;
              }
      
              if (get_Element('sameAsBilling') != 'undefined' && get_Element('sameAsBilling') != null)
              {
                  var sFirstname  = escape(get_Element('shipping_firstname').value);
                  var sLastname = escape(get_Element('shipping_lastname').value);
                  var sCompany  = escape(get_Element('shipping_company').value);
                  var sPhone    = escape(get_Element('shipping_phone').value);
                  var sAddress  = escape(get_Element('shipping_address').value);
                  var sAddress2 = escape(get_Element('shipping_address2').value);
                  var sCity   = escape(get_Element('shipping_city').value);
                  var sState    = escape(get_Element('shipping_state').value);
                  var sCountry  = escape(get_Element('shipping_country').value);
                  var sZip    = escape(get_Element('shipping_zip').value);
              }
              else
              {
                  var sFirstname  = ' ';
                  var sLastname = ' ';
                  var sCompany  = ' ';
                  var sPhone    = ' ';
                  var sAddress  = ' ';
                  var sAddress2 = ' ';
                  var sCity   = ' ';
                  var sState    = ' ';
                  var sCountry  = ' ';
                  var sZip    = ' ';
              }
      
              var bFirstname  = escape(get_Element('billing_firstname').value);
              var bLastname = escape(get_Element('billing_lastname').value);
              var bCompany  = escape(get_Element('billing_company').value);
              var bPhone    = escape(get_Element('billing_phone').value);
              var bAddress  = escape(get_Element('billing_address').value);
              var bAddress2 = escape(get_Element('billing_address2').value);
              var bCity   = escape(get_Element('billing_city').value);
              var bState    = escape(get_Element('billing_state').value);
              var bCountry  = escape(get_Element('billing_country').value);
              var bZip    = escape(get_Element('billing_zip').value);
              var sAddressType = '';

              if (get_Element('shipping_addresstype') != 'undefined' && get_Element('shipping_addresstype') != 'null' && get_Element('shipping_addresstype') != null)
                  sAddressType = escape(get_Element('shipping_addresstype').value);
        
              var myCountry = "US";
                myCountry = jQuery('#' + type + '_country').val();
                if (useAddressValidator == "1" && myCountry == "US"){
                    getElementById_s("hdnAddrressValidatorResult").value = "";
                    var url = 'addressvalidator.asp?no-cache='+Math.random();
                    var params = 'doaction=verify&ct=single&at='+type;
                    params += '&callBack=check_address2_pos(\''+type+'\');';
                    params += '&name=' + escape(getElementById_s(type + "_firstname").value + ' ' + getElementById_s(type + "_lastname").value);
                    if (getElementById_s(type + "_company")) params += '&company=' + escape(getElementById_s(type + "_company").value);
                    params += '&address=' + escape(getElementById_s(type + "_address").value);
                    params += '&address2=' + escape(getElementById_s(type + "_address2").value);
                    params += '&city=' + escape(getElementById_s(type + "_city").value);
                    params += '&state=' + escape(getElementById_s(type + "_state").value);
                    params += '&zip=' + escape(getElementById_s(type + "_zip").value);

                    
                    if ((params != lastShippingAddress || validShippingAddress == 0) && getElementById_s(type + "_address").value != "")
                    {
                        lastShippingAddress = params;
                        jQuery.ajax({
                            url: url,
                            dataType: 'html',
                            type: 'POST',
                            data: params,
                            cache: false,
                            success: function (strResult) {
                                jQuery("#divAddrressValidator").html(strResult);
                            },
                            error: reportError
                        }); 

                        if (overlayAdded)
                            remove_overlay("shipping_info");
                         
                        return false;
                    }
                }
                else
                {
                    validShippingAddress = 1;
                }


              if (get_Element(type+'_email'))
                  get_Element(type+'_email').focus();
              else
                  get_Element(type+'_state').focus();


              var url = 'ship_ajax.asp?no-cache='+Math.random();
              var params = 'shipping_zip=' + szip + '&shipping_city=' + scity + '&shipping_state=' + sstate + '&shipping_country=' + scountry;
              params = params + '&sFirstname=' + sFirstname;
              params = params + '&sLastname=' + sLastname;
              params = params + '&sCompany=' + sCompany;
              params = params + '&sPhone=' + sPhone;
              params = params + '&sAddress=' + sAddress;
              params = params + '&sAddress2=' + sAddress2;
              params = params + '&sCity=' + sCity;
              params = params + '&sState=' + sState;
              params = params + '&sCountry=' + sCountry;
              params = params + '&sZip=' + sZip;
              params = params + '&bFirstname=' + bFirstname;
              params = params + '&bLastname=' + bLastname;
              params = params + '&bCompany=' + bCompany;
              params = params + '&bPhone=' + bPhone;
              params = params + '&bAddress=' + bAddress;
              params = params + '&bAddress2=' + bAddress2;
              params = params + '&bCity=' + bCity;
              params = params + '&bState=' + bState;
              params = params + '&bCountry=' + bCountry;
              params = params + '&bZip=' + bZip;
              params = params + '&sameAsBilling=' + sameAsBilling;
              params = params + '&Addresstype=' + sAddressType;

              var formArray = getValuesAsArray(document.billing);
              for (var prop in formArray) {
                  if (prop == "echoFreightOptions" || prop.toLowerCase().indexOf("collect") > 0) {
                      var value = formArray[prop];
                      value = escape(value);
                      params = params + '&' + prop + '=' + value;
                  }
              }

              jQuery.ajax({
                  url: url,
                  dataType: 'html',
                  type: 'POST',
                  data: params,
                  cache: false,
                  success: function (strResult) {
                      jQuery("#shipResult").html(strResult);
                  },
                  complete: function (strResult) {
                      updateajax(type2);
                  },
                  error: reportError
              });   
          }
      }
  
      function updateajax(request)
      {
          ajax_request_progress=0;
          remove_overlay("billing_info");
    
          if (get_Element('sameAsBilling') != 'undefined' && get_Element('sameAsBilling') != null)
              if (!document.billing.sameAsBilling.checked) 
                  remove_overlay("shipping_info");

          remove_overlay("shipping_div");
          remove_overlay("total_div");
          remove_overlay("divPayment");
      }
  
      function reportError(jqXHR, textStatus) {
          isSubmitComplete = false;
          ajax_request_progress=0;
          remove_overlay("billing_info");

          if (get_Element('sameAsBilling') != 'undefined' && get_Element('sameAsBilling') != null)
              if (!document.billing.sameAsBilling.checked) 
                  remove_overlay("shipping_info");
          if (jqXHR.status > 0)
          {
              alert("Error processing request " + jqXHR.status + " - " + jqXHR);
          }
      }

      function showHideShipping() {

          if (get_Element('sameAsBilling') != 'undefined' && get_Element('sameAsBilling') != null)
          {
              if (document.billing.sameAsBilling.checked) 
              {
                  add_overlay("shipping_info",0);
        
                  get_Element('shipping_firstname').value = '';
                  get_Element('shipping_lastname').value = '';
                  get_Element('shipping_company').value = '';
                  get_Element('shipping_phone').value = '';
                  get_Element('shipping_address').value = '';
                  get_Element('shipping_address2').value = '';
                  get_Element('shipping_city').value = '';
                  get_Element('shipping_zip').value = ''; 
                  get_Element('shipping_country').value = get_Element('billing_country').value;
                  populateState('shipping_state','shipping_country');   
                  get_Element('shipping_state').value   = get_Element('billing_state').value; 
              }
              else 
              {
                  remove_overlay("shipping_info");
        
                  if (get_Element('shipping_firstname').value != "[shipping_firstname]")
                  {
                      get_Element('shipping_firstname').value = get_Element('billing_firstname').value;
                      get_Element('shipping_lastname').value  = get_Element('billing_lastname').value;
                      get_Element('shipping_company').value = get_Element('billing_company').value;
                      get_Element('shipping_phone').value   = get_Element('billing_phone').value;
                      get_Element('shipping_address').value = get_Element('billing_address').value;
                      get_Element('shipping_address2').value  = get_Element('billing_address2').value;
                      get_Element('shipping_city').value    = get_Element('billing_city').value;
                      get_Element('shipping_zip').value   = get_Element('billing_zip').value; 
                      get_Element('shipping_country').value = get_Element('billing_country').value;
                      populateState('shipping_state','shipping_country');
                      get_Element('shipping_state').value   = get_Element('billing_state').value;
                  }
              }
          }
      }

      function selectGiftRegAddress() {
          remove_overlay("shipping_info");
    
          if (get_Element('sameAsBilling') != 'undefined' && get_Element('sameAsBilling') != null)
          {
              get_Element('sameAsBilling').checked = false;
          }
          get_Element('shipping_firstname').value = get_Element('giftreg_shipping_firstname').value;
          get_Element('shipping_lastname').value  = get_Element('giftreg_shipping_lastname').value;
          get_Element('shipping_company').value = get_Element('giftreg_shipping_company').value;
          get_Element('shipping_phone').value   = get_Element('giftreg_shipping_phone').value;
          get_Element('shipping_address').value = get_Element('giftreg_shipping_address').value;
          get_Element('shipping_address2').value  = get_Element('giftreg_shipping_address2').value;
          get_Element('shipping_city').value    = get_Element('giftreg_shipping_city').value;
          get_Element('shipping_zip').value   = get_Element('giftreg_shipping_zip').value;  
          get_Element('shipping_country').value = get_Element('giftreg_shipping_country').value;
          populateState('shipping_state','shipping_country');
          get_Element('shipping_state').value   = get_Element('giftreg_shipping_state').value;      
          check_address('');
      }
  
      function getElementById_s(id){ 
          var obj = null; 
          if(document.getElementById){ 
              /* Prefer the widely supported W3C DOM method, if 
                available:- 
                */ 
              obj = get_Element(id); 
          }else if(document.all){ 
              obj = document.all[id]; 
          } 
          return obj; 
      } 

      function remove_overlay(panel)
      {
          var objBody = getElementById_s('overlay_'+panel);
          if (objBody != null && objBody != 'null' && objBody != undefined && objBody != 'undefined')
              objBody.style.display = 'none';
      }

      function add_overlay(panel,loading)
      {
          var objBody = getElementById_s(panel);
          var objOverlay = document.createElement("div");
    
          objOverlay.setAttribute('id','overlay_'+panel); 
          objOverlay.className='overlay';
          objOverlay.style.position = 'absolute';
          objOverlay.style.textAlign = 'center';
          objOverlay.style.width = objBody.clientWidth+"px";
          objOverlay.style.height = objBody.clientHeight+"px";
          //alert(objOverlay.style.height);
          objBody.insertBefore(objOverlay, objBody.firstChild);
          objOverlay.style.display = 'block';
   
          if (loading==1)
          {
              get_Element('overlay_'+panel).innerHTML = '<table border=0 width=100% height=100%><tr><td style="text-align: center;"><img src="assets/templates/common/images/loading.gif"></td></tr></table>';
          }
          else
          {
              get_Element('overlay_'+panel).innerHTML = '<table border=0 width=100% height=100%><tr><td align="center"></td></tr></table>';
          }
          DisableEnableForm(document.billing,false);
      }   

      function DisableEnableForm(xForm,xHow)
      {
          objElems = xForm.elements;
          for(i=0;i<objElems.length;i++)
          {
              objElems[i].disabled = xHow;
          } 
      }
  

      function fillEmailDiv()
      {
          var strValue = get_Element('billing_email').value;
          if (strValue == '')
              strValue = 'Type your email above';
          if (get_Element('divEmail') != 'undefined' && get_Element('divEmail') != null)
          {
              strValue = "&nbsp;" + jQuery.trim(removeHTMLTags(strValue));
              get_Element('divEmail').innerHTML = strValue;
          }
      }
  
      function updateOrderEmail()
      {
          var strValue = get_Element('billing_email').value;
          //alert(strValue);
          var url = 'ship_ajax.asp?action=updateOrderEmail&no-cache='+Math.random();
          var params = 'email=' + escape(strValue);

          jQuery.ajax({
              url: url,
              dataType: 'html',
              type: 'POST',
              data: params,
              cache: false
          });
      }
  
      function removeHTMLTags(strString)
      {
          var strInputCode = strString;
      
          strInputCode = strInputCode.replace(/&(lt|gt);/g, function (strMatch, p1){
              return (p1 == "lt")? "<" : ">";
          });
          var strTagStrippedText = strInputCode.replace(/<\/?[^>]+(>|$)/g, "");
          strTagStrippedText = strTagStrippedText.replace(/\u00a0/g,'');
          //strTagStrippedText = strTagStrippedText.replace(/&nbsp;/gi,'');
          return strTagStrippedText;
      }
  
      function clearContent(obj)
      {
          obj.value = removeHTMLTags(obj.value);
      }
  
      function controlDivPayment(id)
      {
          var divs = document.getElementsByTagName("div");
          for (var x = 0; x < divs.length; x++)
          {
              if ((divs[x].id.indexOf("divPaymentOption") >= 0))
              {
                  obj1=get_Element(divs[x].id);
                
                  if (obj1!=undefined)
                      if (id == '')
                      {
                          obj1.style.display = '';
                          break;
                      }
                      else
                      {
                          if (obj1.id == 'divPaymentOption'+id)
                              obj1.style.display = '';
                          else
                              obj1.style.display = 'none';
                      }
              }
          } 
      } 
        $scope.showcart = function() {
          if (sessionStorage.getItem("cartnum") > 0) {
            TINY.box.show({
              iframe : 'cart.html',
              boxid : 'frameless',
              width : 750,
              height : 450,
              fixed : true,
              maskid : 'blackmask',
              maskopacity : 40,
              closejs : function() {
                closeJS()
              }
            });  
      function controlDivShipping(id)
      {
          var divs = document.getElementsByTagName("div");
          for (var x = 0; x < divs.length; x++)
          {
              if (divs[x].id.indexOf("divShipping") >= 0 && divs[x].id != "divShipping" && divs[x].id != "divShippingCUSTOM")
              {
                  obj1=get_Element(divs[x].id);
                
                  if (obj1!=undefined)
                      if (id == '')
                      {
                          obj1.style.display = '';
                          break;
                      }
                      else
                      {
                          if (obj1.id == 'divShipping'+id)
                              obj1.style.display = '';
                          else
                              obj1.style.display = 'none';
                      }
              }
          } 
      }   
  
      //utilities.js
      addLoadEvent(initpage);
  
</script>
<center>
  <form action="checkout_one.asp" method="post" name="billing" id="billing">
    <div id="billing_div" style="width:100%;">
      <table width="98%" cellpadding="0" cellspacing="6" border="0">
        <tr>
          <td colspan="2"><div id="divCart" style="width:100%;"> 
              <!--START: SHOPPING_CART_TEMP-->
              <table cellpadding="0" cellspacing="0" border="0" width="100%">
                <tr>
                  <td class="page_headers" align="left" colspan="5">Zappos Checkout Page</td>
                </tr>
                <tr>
                  <td height="10" colspan="5"><img src="assets/templates/common/images/spacer.gif" alt="" width="1" height="10" /></td>
                </tr>
                <!--START: CATEGORY_HEADER-->
                <tr>
                  <td height="10" colspan="5"><table width="100%" cellspacing="0" cellpadding="2" border="0">
                      <tr>
                        <td class="data">[CONTENT]</td>
                      </tr>
                    </table></td>
                </tr>
                <tr>
                  <td height="10" colspan="5"><img src="assets/templates/common/images/spacer.gif" alt="" width="1" height="10" /></td>
                </tr>
                <!--END: CATEGORY_HEADER-->
                <tr>
                  <td class="titles2" align="left" colspan="2" width="10%"><strong>Items in the Shopping cart</strong></td>
                  <td class="titles2" align="center"><strong>[shoppingcart_quantity]</strong></td>
                  <td class="titles2" align="right"><strong>[shoppingcart_price]</strong></td>
                  <td class="titles2" align="right"><strong>[shoppingcart_total]</strong></td>
                </tr>
                <tr>
                  <td height="1" colspan="5" class="borders"><img src="assets/templates/common/images/spacer.gif" height="1"></td>
                </tr>
                <!--START: SHOPPING_CART_ITEM-->
                <tr>
                  <td width="15%" height="60" valign="middle"><a href="product.asp?itemid=[ITEM_CATALOGID]"><img src="thumbnail.asp?file=[THUMBNAIL]" border="0" height="55" width="55" /></a></td>
                  <td class="item" valign="middle" align="left" width="55%"><a href="" ng-click="showcart()"> ITEMS IN CART </a> 
                    <!--START: itemoptions--> 
                    <br />
                    <a href='#' onClick="toggleProdOptions('opt[ITEM_ID]')">View/Hide options</a><br />
                    <div id=opt[ITEM_ID] name=opt[ITEM_ID] style="display:none;">[OPTIONS]</div>
                    <!--END: itemoptions--> 
                    <!--START: recurring_frequency--> 
                    <br />
                    This item will Autoship every <b>[recurring_frequency]</b> 
                    <!--END: recurring_frequency--></td>
                  <td valign="middle" class="item" align="center">[ITEM_QUANTITY]
                    <input type="hidden" name="coliditemnum" value="[ITEM_ID]" size="3" maxlength="5" id="Hidden3" /></td>
                  <td valign="middle" class="item" align="right">[ITEM_PRICE]</td>
                  <td valign="middle" class="item" align="right">[ITEM_SUBTOTAL]</td>
                </tr>
                <tr>
                  <td height="1" colspan="6" class="borders"><img src="assets/templates/common/images/spacer.gif" height="1"></td>
                </tr>
                <!--END: SHOPPING_CART_ITEM-->
              </table>
              
              <!--END: SHOPPING_CART_TEMP--> 
            </div></td>
        </tr>
        <!--START: account_login1-->
        <tr>
          <td colspan="2"><table width="100%" cellpadding="0" cellspacing="4" class="alternative">
              <tr>
                <td class="item"> [checkout1_loginmessage2] <br />
                  <br />
                  <div style="float: left;">
                    <input type="button" value="[checkout1_login]" name="B3" onclick="document.location='checkout.asp?step=log-in';" class="btn" onmouseover="this.className='btn_over'" onmouseout="this.className='btn'" />
                  </div>
              </tr>
            </table></td>
        </tr>
        <!--END: account_login1-->
        <tr>
          <td colspan="2">&nbsp;</td>
        </tr>
        <tr> 
          <!-- start left bar-->
          <td valign="top" width="50%"><table width="100%" cellpadding="0" cellspacing="0">
              <tr>
                <td colspan="2" class="checkout-headers"> [account_billing-info] </td>
              </tr>
              <tr>
                <td><div id="billing_info" style="width:100%">
                    <table width="100%" cellpadding="0" cellspacing="0">
                      <tr>
                        <td>
                            <div id="billing_info2" style="width:100%">
                            <table width="100%" cellpadding="0" cellspacing="4" class="alternative">
                            <tr>
                              <td width="31%" align="right" class="item"><b>[CustomerInfo_firstname]</b></td>
                              <td nowrap><input name="billing_firstname" onChange="clearContent(this);" type="text" id="billing_firstname" value="[billing_firstname]" size="15" class="txtBoxStyle">
                                <!--START: req_billing_firstname--> 
                                <img src="assets/templates/common/images/error2.gif" width="12" height="12"> 
                                <!--END: req_billing_firstname--></td>
                            </tr>
                            <tr>
                              <td align="right" class="item"><b>[CustomerInfo_lastname]</b></td>
                              <td nowrap><input name="billing_lastname" type="text" onChange="clearContent(this);" id="billing_lastname" value="[billing_lastname]" size="15" class="txtBoxStyle">
                                <!--START: req_billing_lastname--> 
                                <img src="assets/templates/common/images/error2.gif" width="12" height="12"> 
                                <!--END: req_billing_lastname--></td>
                            </tr>
                            <tr>
                              <td align="right" class="item"><b>[CustomerInfo_company]</b></td>
                              <td><input name="billing_company" type="text" onChange="clearContent(this);" id="billing_company" value="[billing_company]" size="25" class="txtBoxStyle"></td>
                            </tr>
                            <tr>
                              <td align="right" class="item"><b>[CustomerInfo_phone]</b></td>
                              <td nowrap><input name="billing_phone" type="text" onChange="clearContent(this);" id="billing_phone" value="[billing_phone]" size="25" class="txtBoxStyle">
                                <!--START: req_billing_phone--> 
                                <img src="assets/templates/common/images/error2.gif" width="12" height="12"> 
                                <!--END: req_billing_phone--></td>
                            </tr>
                            <tr>
                              <td align="right" class="item"><b>[CustomerInfo_address]</b></td>
                              <td nowrap><input name="billing_address" type="text" onChange="clearContent(this);[po_box_disabled_billing]" id="billing_address" value="[billing_address]" size="25" class="txtBoxStyle">
                                <!--START: req_billing_address--> 
                                <img src="assets/templates/common/images/error2.gif" width="12" height="12"> 
                                <!--END: req_billing_address--></td>
                            </tr>
                            <tr>
                              <td align="right" class="item"><b>[CustomerInfo_address2]</b></td>
                              <td><input name="billing_address2" type="text" onChange="clearContent(this);" id="billing_address2" value="[billing_address2]" size="25" class="txtBoxStyle"></td>
                            </tr>
                            <tr>
                              <td align="right" class="item"><b>[CustomerInfo_city]</b></td>
                              <td nowrap><input name="billing_city" type="text" onChange="clearContent(this);" id="billing_city" value="[billing_city]" size="25" class="txtBoxStyle">
                                
                                <!--START: req_billing_city--> 
                                <img src="assets/templates/common/images/error2.gif" width="12" height="12"> 
                                <!--END: req_billing_city--></td>
                            </tr>
                            <tr>
                              <td align="right" class="item"><b>[CustomerInfo_country]</b></td>
                              <td nowrap><select name="billing_country" onChange="this.form.billing_zip.value='';populateState('billing_state','billing_country');check_stateValidator('billing');check_address('billing');" class="txtBoxStyle" id="billing_country">
                                </select>
                                <!--START: req_billing_country--> 
                                <img src="assets/templates/common/images/error2.gif" width="12" height="12"> 
                                <!--END: req_billing_country--></td>
                            </tr>
                            <tr>
                              <td align="right" class="item"><b>[CustomerInfo_state]</b></td>
                              <td nowrap><span>
                                <select id="billing_state" onChange="this.form.billing_zip.value='';check_address('billing');" name="billing_state" class="txtBoxStyle">
                                </select>
                                </span> 
                                <!--START: req_billing_state--> 
                                <img src="assets/templates/common/images/error2.gif" width="12" height="12"> 
                                <!--END: req_billing_state--></td>
                            </tr>
                            <tr>
                              <td align="right" class="item"><b>[CustomerInfo_zip]</b></td>
                              <td nowrap><input name="billing_zip" maxlength="15" type="text" id="billing_zip" value="[billing_zip]" size="10" class="txtBoxStyle" onChange="clearContent(this);check_address('billing');" >
                                
                                <!--START: req_billing_zip--> 
                                <img src="assets/templates/common/images/error2.gif" width="12" height="12"> 
                                <!--END: req_billing_zip--></td>
                            </tr>
                            <tr>
                              <td align="right" class="item"><b>[CustomerInfo_email]</b></td>
                              <td nowrap><input name="billing_email" type="text" id="billing_email" maxlength="50" onBlur="fillEmailDiv();" onKeyUp="fillEmailDiv();" onChange="clearContent(this);fillEmailDiv();updateOrderEmail();" value="[email]" size="25" class="txtBoxStyle">
                                
                                <!--START: emailrequired--> 
                                <!--START: req_email--> 
                                <img src="assets/templates/common/images/error2.gif" width="12" height="12"> 
                                <!--END: req_email--> 
                                <!--END: emailrequired--></td>
                            </tr>
                            <!--START: confirm_email-->
                            <tr>
                              <td align="right" class="item"><b>[CustomerInfo_confirmemail]</b></td>
                              <td nowrap><input name="billing_confirmemail" type="text" id="billing_confirmemail" maxlength="50" value="" size="25" class="txtBoxStyle">
                                
                                <!--START: emailrequired--> 
                                <!--START: req_email--> 
                                <img src="assets/templates/common/images/error2.gif" width="12" height="12"> 
                                <!--END: req_email--> 
                                <!--END: emailrequired--></td>
                            </tr>
                            <!--END: confirm_email-->
                            <tr>
                              <td align="right" class="item"><input type="checkbox" value="1" name="maillist" [maillist] id="Checkbox1"></td>
                              <td class="item">[checkout1_joinmailinglist]</td>
                            </tr>
                          </table>
                          <br />
                          </div></td>
                      </tr>
                      <tr>
                        <td><table width="100%" cellpadding="0" cellspacing="4" class="alternative">
                          </table>
                          <br /></td>
                      </tr>
                    </table>
                  </div></td>
              </tr>
            </table></td>
          <!-- end left bar--> 
          <!-- start right bar-->
          <td valign="top" align="right"><!--START: GIFT_REGISTRY_SHIPPING-->
            <input type="hidden" name="giftreg_shipping_firstname" id="giftreg_shipping_firstname" value="[giftreg_shipping_firstname]">
            <input type="hidden" name="giftreg_shipping_lastname" id="giftreg_shipping_lastname" value="[giftreg_shipping_lastname]">
            <input type="hidden" name="giftreg_shipping_company" id="giftreg_shipping_company" value="[giftreg_shipping_company]">
            <input type="hidden" name="giftreg_shipping_phone" id="giftreg_shipping_phone" value="[giftreg_shipping_phone]">
            <input type="hidden" name="giftreg_shipping_address" id="giftreg_shipping_address" value="[giftreg_shipping_address]">
            <input type="hidden" name="giftreg_shipping_address2" id="giftreg_shipping_address2" value="[giftreg_shipping_address2]">
            <input type="hidden" name="giftreg_shipping_city" id="giftreg_shipping_city" value="[giftreg_shipping_city]">
            <input type="hidden" name="giftreg_shipping_zip" id="giftreg_shipping_zip" value="[giftreg_shipping_zip]">
            <input type="hidden" name="giftreg_shipping_country" id="giftreg_shipping_country" value="[giftreg_shipping_country]">
            <input type="hidden" name="giftreg_shipping_state" id="giftreg_shipping_state" value="[giftreg_shipping_state]">
            <table width="97%" cellpadding="0" cellspacing="0">
              <tr>
                <td class="checkout-headers" colspan="2">[checkout1_Header-giftreg]</td>
              </tr>
              <tr>
                <td colspan="2" align="left"><table width="100%" cellpadding="3" cellspacing="0" class="alternative">
                    <tr>
                      <td colspan="2" class="item">[checkout1_Header-giftreg-instructions]</td>
                    </tr>
                  </table>
                  <br /></td>
              </tr>
            </table>
            
            <!--END: GIFT_REGISTRY_SHIPPING-->
            
            <table width="97%" cellpadding="0" cellspacing="0">
              <tr class="checkout-headers">
                <td class="checkout-headers">[checkout1_Header-shippinginformation]</td>
                <!--START: sameAsBilling1-->
                <td class="checkout-headers" valign="middle" width="130"><input type="checkbox" value="ON" name="sameAsBilling" id="sameAsBilling" onClick="showHideShipping();check_address('');">
                  <span class="item">[checkout3_sameasbilling]</span></td>
                <!--END: sameAsBilling1--> 
              </tr>
              <tr>
                <td colspan="3" align="right"><div id="shipping_info" style="width:100%;">
                    <table width="100%" cellpadding="0" cellspacing="0">
                      <tr>
                        <td><!--START: sameAsBilling2-->
                          
                          <table width="100%" cellpadding="0" cellspacing="4" class="alternative">
                            <tr>
                              <td width="30%" align="right" class="item"><b>[CustomerInfo_firstname]</b></td>
                              <td><input name="shipping_firstname" onChange="clearContent(this);" type="text" id="shipping_firstname" value="[shipping_firstname]" size="15" class="txtBoxStyle">
                                <!--START: req_shipping_firstname--> 
                                <img src="assets/templates/common/images/error2.gif" width="12" height="12"> 
                                <!--END: req_shipping_firstname--></td>
                            </tr>
                            <tr>
                              <td align="right" class="item"><b>[CustomerInfo_lastname]</b></td>
                              <td><input name="shipping_lastname" onChange="clearContent(this);" type="text" id="shipping_lastname" value="[shipping_lastname]" size="15" class="txtBoxStyle">
                                <!--START: req_shipping_lastname--> 
                                <img src="assets/templates/common/images/error2.gif" width="12" height="12"> 
                                <!--END: req_shipping_lastname--></td>
                            </tr>
                            <tr>
                              <td align="right" class="item"><b>[CustomerInfo_company]</b></td>
                              <td><input name="shipping_company" onChange="clearContent(this);" type="text" id="shipping_company" value="[shipping_company]" size="25" class="txtBoxStyle"></td>
                            </tr>
                            <tr>
                              <td align="right" class="item"><b>[CustomerInfo_phone]</b></td>
                              <td nowrap><input name="shipping_phone" onChange="clearContent(this);" type="text" id="shipping_phone" value="[shipping_phone]" size="25" class="txtBoxStyle">
                                <!--START: req_shipping_phone--> 
                                <img src="assets/templates/common/images/error2.gif" width="12" height="12"> 
                                <!--END: req_shipping_phone--></td>
                            </tr>
                            <tr>
                              <td align="right" class="item"><b>[CustomerInfo_address]</b></td>
                              <td nowrap><input name="shipping_address" onChange="clearContent(this);[po_box_disabled_shipping]" type="text" id="shipping_address" value="[shipping_address]" size="25" class="txtBoxStyle">
                                <!--START: req_shipping_address--> 
                                <img src="assets/templates/common/images/error2.gif" width="12" height="12"> 
                                <!--END: req_shipping_address--></td>
                            </tr>
                            <tr>
                              <td align="right" class="item"><b>[CustomerInfo_address2]</b></td>
                              <td nowrap><input name="shipping_address2" onChange="clearContent(this);" type="text" id="shipping_address2" value="[shipping_address2]" size="25" class="txtBoxStyle"></td>
                            </tr>
                            <tr>
                              <td align="right" class="item"><b>[CustomerInfo_city]</b></td>
                              <td nowrap><input name="shipping_city" onChange="clearContent(this);" type="text" id="shipping_city" value="[shipping_city]" size="25" class="txtBoxStyle">
                                <!--START: req_shipping_city--> 
                                <img src="assets/templates/common/images/error2.gif" width="12" height="12"> 
                                <!--END: req_shipping_city--></td>
                            </tr>
                            <tr>
                              <td align="right" class="item"><b>[CustomerInfo_country]</b></td>
                              <td nowrap><select name="shipping_country" onChange="this.form.shipping_zip.value='';populateState('shipping_state','shipping_country');check_stateValidator('shipping');check_address('shipping');" class="txtBoxStyle" id="shipping_country">
                                </select>
                                <!--START: req_shipping_country--> 
                                <img src="assets/templates/common/images/error2.gif" width="12" height="12"> 
                                <!--END: req_shipping_country--></td>
                            </tr>
                            <tr>
                              <td align="right" class="item"><b>[CustomerInfo_state]</b></td>
                              <td nowrap><select id="shipping_state" onChange="this.form.shipping_zip.value='';check_address('shipping');" name="shipping_state" class="txtBoxStyle">
                                </select>
                                <!--START: req_shipping_state--> 
                                <img src="assets/templates/common/images/error2.gif" width="12" height="12"> 
                                <!--END: req_shipping_state--></td>
                            </tr>
                            <tr>
                              <td align="right" class="item"><b>[CustomerInfo_zip]</b></td>
                              <td nowrap><input name="shipping_zip" maxlength="15" type="text" id="shipping_zip" value="[shipping_zip]" size="10" class="txtBoxStyle" onChange="clearContent(this);check_address('shipping');" >
                                <!--START: req_shipping_zip--> 
                                <img src="assets/templates/common/images/error2.gif" width="12" height="12"> 
                                <!--END: req_shipping_zip--></td>
                            </tr>
                          </table>
                          <!--END: sameAsBilling2--> 
                          <!--START: sameAsBilling3-->
                          <table width="100%" cellpadding="3" cellspacing="0" id="Table29">
                            <tr>
                              <td align="center" class="item"><br />
                                [checkout3_sameasbillingmessage]</strong></td>
                            </tr>
                          </table>
                          <!--END: sameAsBilling3--> 
                          <br /></td>
                      </tr>
                    </table>
                  </div></td>
              </tr>
            </table></td>
          <!-- end right bar--> 
        </tr>
        <tr> 
          <!-- start left bar2-->
          <td valign="top" width="50%"><table width="100%" cellpadding="0" cellspacing="0">
            </table></td>
          <!-- end left bar2--> 
          <!-- start right bar2-->
          <td valign="top" align="right"><table width="95%" cellpadding="0" cellspacing="0">
              <tr>
                <td class="checkout-headers" colspan="3" valign="top">[checkout3_orderTotal]</td>
              </tr>
              <tr>
                <td colspan="3"><div id="total_div" name="total_div" style="width:100%;"> 
                    <!--START: total_template_noshipping-->
                    <table width="100%" cellpadding="0" cellspacing="2" id="Table30" border="0" class="alternative">
                      <tr>
                        <td height="15" style="font-size:10pt;"><p>[checkout3_totalinstructions]</p></td>
                      </tr>
                    </table>
                    <!--END: total_template_noshipping--> 
                    <!--START: total_template-->
                    <table width="100%" cellpadding="0" cellspacing="2" id="Table20" border="0" class="alternative">
                      <tr>
                        <td class="item"><strong>[itemCount] Item(s)</strong>:</td>
                        <td class="item" style="text-align:right;">[SUBTOTAL]</td>
                      </tr>
                      <!--START: DISCOUNTS-->
                      <tr>
                        <td class="item"><strong>[shoppingcart_discount]</strong>: <a href="javascript:showDiscountDetails();">(details)</a></td>
                        <td class="item" style="text-align:right;">- [DISCOUNT]</td>
                      </tr>
                      <!--START: PROMOTIONS-->
                      <tr>
                        <td colspan="2" align="center"><div id="divDiscountDetails" name="divDiscountDetails" style="width:100%;align:center;display:none;background:#efefef;">
                            <table width="100%" cellpadding="0" cellspacing="2" id="Table28" border="0">
                              <tr>
                                <td class="item"><b>Promotion Name</td>
                                <td class="item"></td>
                              </tr>
                              <!--START: DISPLAY_PROMOS-->
                              <tr>
                                <td class="item">[promotion_name]</td>
                                <td class="item" style="text-align:right;"><a href="javascript:removeCoupon('[id]');">remove</a></td>
                              </tr>
                              <!--END: DISPLAY_PROMOS-->
                            </table>
                          </div></td>
                      </tr>
                      <!--END: PROMOTIONS--> 
                      <!--END: DISCOUNTS--> 
                      <tr>
                        <td class="item" ><strong>[shoppingcart_shipping]</strong>:</td>
                        <td class="item" style="text-align:right;">[SHIPPING]</td>
                      </tr>
                      <tr>
                        <td class="item"><strong>[shoppingcart_taxes]</strong>:</td>
                        <td class="item" style="text-align:right;">[TAX]</td>
                      </tr>
                      <tr>
                        <td class="item"><strong>[shoppingcart_total]</strong>:</td>
                        <td class="item" style="text-align:right;">[TOTAL]</td>
                      </tr>

                      <tr>
                        <td class="item" colspan="2"><hr></td>
                      </tr>
                      <tr>
                        <td class="item"><strong>[shoppingcart_balance]</strong>:</td>
                        <td class="item" style="text-align:right;"><span class="price">[BALANCE]</span></td>
                      </tr>
                      <tr>
                        <td class="item" colspan="2"><hr></td>
                      </tr>
                    </table>
                    <!--END: total_template--> 
                  </div></td>
              </tr>
            </table></td>
          <!-- end right bar2--> 
        </tr>
        <tr>
          <td colspan="2"><div id="divPayment" style="width:100%"> 

            <br />
              <tr>
                <td align="right"><div id="spanCheckout"><div id="divCheckout" name="divCheckout" style="width:80%;display:none;background:#ffffff;border:0px solid black;text-align:center;padding:10px;"> <br />
                    Processing... </div>
                    <a name="checkoutButton">
                    <input type="button" value="[checkout3_submitbutton]" name="btnCheckout" id="btnCheckout" class="btn" onClick="doCheckout(this.form);"/></div></td>
              </tr>
            </table></td>
        </tr>
        <tr>
          <td colspan="10"><!--START: CATEGORY_FOOTER-->
            
            <table width="100%" cellspacing="0" cellpadding="2" border="0">
              <tr>
                <td class="item">[CONTENT]</td>
              </tr>
            </table>
            
            <!--END: CATEGORY_FOOTER--></td>
        </tr>
      </table>
    </div>
  </form>
  <script>
  window.setTimeout('showHideShipping_init()',100);

  function showHideShipping_init()
  {
    var objBody = getElementById_s('shipping_info');  
    var intWidth = objBody.clientWidth;
    if (intWidth == 0)
      window.setTimeout('showHideShipping_init()',100);
    else
      showHideShipping();
  }
  
  initCountry('[billing_country]','[billing_state_script]','billing_state','billing_country');
  if (get_Element('shipping_state') != 'undefined' && get_Element('shipping_state') != null)
    initCountry('[shipping_country]','[shipping_state_script]','shipping_state','shipping_country');
  
  //Every time that there's no state for a selected country, that script deletes the state control and creates another one.
  //That's why we need to re-create the validation for the state.
  var billingStateType = document.billing.billing_state.type;
  if (get_Element('sameAsBilling') != 'undefined' && get_Element('sameAsBilling') != null)
    var shippingStateType = document.billing.shipping_state.type;
  
  function check_stateValidator(type)
  {
    if (type == 'billing')
    {
      if (document.billing.billing_state.type != billingStateType)
      {
        frmvalidator.addValidation("billing_state","req","Please enter/select your billing state");
        frmvalidator.addValidation("billing_state","maxlen=50");
        billingStateType = document.billing.billing_state.type;
      }
    }
    else
    {
      if (document.billing.shipping_state.type != shippingStateType)
      {
        frmvalidator.addValidation("shipping_state","req","Please enter/select your shipping state");
        frmvalidator.addValidation("shipping_state","maxlen=50");
        shippingStateType = document.billing.shipping_state.type;
      }   
    }
  }

  function setValidation()
  {
    frmvalidator.clearAllValidations();
    
    frmvalidator.addValidation("billing_firstname","req","Please enter your billing First Name");
    frmvalidator.addValidation("billing_firstname","maxlen=20","Max length for billing First Name is 20");

    frmvalidator.addValidation("billing_lastname","req","Please enter your billing Last Name");
    frmvalidator.addValidation("billing_lastname","maxlen=20","Max length for billing Last Name is 20");

    <!--START: phonerequiredscript-->
    frmvalidator.addValidation("billing_phone","maxlen=18","Max length for billing Phone is 18");
        if (get_Element('billing_country') != 'undefined' && get_Element('billing_country') != null)
            if (get_Element('billing_country').value == "US")
            frmvalidator.addValidation("billing_phone","phone","Invalid phone number.");
    frmvalidator.addValidation("billing_phone","req","Please enter your billing phone")
    <!--END: phonerequiredscript-->

    frmvalidator.addValidation("billing_address","maxlen=50");
    frmvalidator.addValidation("billing_address","req","Please enter your billing address");

    frmvalidator.addValidation("billing_city","maxlen=50");
    frmvalidator.addValidation("billing_city","req","Please enter your billing city");

        if (get_Element('billing_country').value == "US")
        {
        frmvalidator.addValidation("billing_state","req","Please enter/select your billing state");
        frmvalidator.addValidation("billing_state","maxlen=50");
        }

    frmvalidator.addValidation("billing_zip","maxlen=15");
    frmvalidator.addValidation("billing_zip","req","Please enter your billing zip code");
    
    <!--START: emailrequiredscript-->
    frmvalidator.addValidation("billing_email","maxlen=50","Max length for Email is 50");
    frmvalidator.addValidation("billing_email","req","Please enter your email address");
    frmvalidator.addValidation("billing_email","email");    
    <!--END: emailrequiredscript-->
    
    <!--START: confirmemailscript-->
    if (document.billing.billing_confirmemail != null && document.billing.billing_confirmemail != 'undefined')
    {
      frmvalidator.addValidation("billing_confirmemail","maxlen=50","Max length for Email is 50");
      frmvalidator.addValidation("billing_confirmemail","req","Please confirm your Email.");
      frmvalidator.addValidation("billing_confirmemail","email","Please confirm your Email.");
      frmvalidator.setAddnlValidationFunction("confirmationValidation");
    }
    <!--END: confirmemailscript-->

    <!--START: passwordrequiredscript-->
    frmvalidator.addValidation("pass","maxlen=20");
    frmvalidator.addValidation("pass","req","Please enter your new password (registration is required)");
    <!--END: passwordrequiredscript-->
        
    frmvalidator.addValidation("billing_country","dontselect=0");
        
    if (get_Element('sameAsBilling') != 'undefined' && get_Element('sameAsBilling') != null)
      if (!document.billing.sameAsBilling.checked)
      {
        frmvalidator.addValidation("shipping_firstname","req","Please enter your shipping First Name");
        frmvalidator.addValidation("shipping_firstname","maxlen=20","Max length for shipping First Name is 20");

        frmvalidator.addValidation("shipping_lastname","req","Please enter your shipping Last Name");
        frmvalidator.addValidation("shipping_lastname","maxlen=20","Max length for shipping Last Name is 20");
        <!--START: phonerequiredscript-->
        frmvalidator.addValidation("shipping_phone","maxlen=18","Max length for shipping Phone is 18");
                if (get_Element('shipping_country') != 'undefined' && get_Element('shipping_country') != null)
                    if (get_Element('shipping_country').value == "US")
                    frmvalidator.addValidation("shipping_phone","phone","Invalid phone number.");
        frmvalidator.addValidation("shipping_phone","req","Please enter your shipping phone")
        <!--END: phonerequiredscript-->
        frmvalidator.addValidation("shipping_address","maxlen=50");
        frmvalidator.addValidation("shipping_address","req","Please enter your shipping address");

        frmvalidator.addValidation("shipping_city","maxlen=50");
        frmvalidator.addValidation("shipping_city","req","Please enter your shipping city");

                if (get_Element('shipping_country').value == "US")
                {
            frmvalidator.addValidation("shipping_state","req","Please enter/select your shipping state");
            frmvalidator.addValidation("shipping_state","maxlen=50");
                }

        frmvalidator.addValidation("shipping_zip","maxlen=15");
        frmvalidator.addValidation("shipping_zip","req","Please enter your shipping zip code");

        frmvalidator.addValidation("shipping_country","dontselect=0");    
      }
      
  }
</script> 
<script type="text/javascript">
var frmvalidator = new Validator("billing");
frmvalidator.EnableMsgsTogether();

function confirmationValidation()
{
    if(get_Element("billing_email").value != get_Element("billing_confirmemail").value)
    {
        alert('The Email does not match.');
        return false;
    }
    return true;
}
</script> 