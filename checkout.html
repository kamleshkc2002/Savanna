<!DOCTYPE html>
<html lang="en" class="no-js" ng-app="myApp">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Savanna | HCI Project</title>
    <meta name="description" content="Zappos Application for Discount Notification" />
    <meta name="keywords" content="Zappos, Application, Shoes, Clothing" />
    <meta name="author" content="Kamlesh" />
    <link rel="shortcut icon" href="../favicon.ico">
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/angularjs/1.2.10/angular-sanitize.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.2.13/angular.min.js"></script>
    <script src="js/modernizr.custom.js"></script>
    <script type="text/javascript" src="tinybox.js"></script>
    <link rel="stylesheet" type="text/css" href="css/default.css" />
    <link rel="stylesheet" type="text/css" href="css/component.css" />
    <link rel="stylesheet" type="text/css" href="css/style.css" />
    <!-- Make sure my AngularJS calls our API as a "GET", rather than as an "OPTION"-->
    
    <script>
      var myApp = angular.module('myApp', []);
      myApp.config(['$httpProvider',
      function($httpProvider) {

        $httpProvider.defaults.useXDomain = true;
        delete $httpProvider.defaults.headers.common['X-Requested-With'];
      }]);

      // my function to populate the product details

      function AngularController($scope, $http) {
        $scope.searchItem = null;
        $scope.totalcost = 0;
        $scope.numofitems = 0;
        $scope.listOfProducts = null;

        $scope.loadproductdetails = function() {
          $scope.numofitems = 0;
          $scope.totalcost = 0.00;
          var jsobj = []; //temp var to store api's result
          var cartjson = []; //all products in cart will be populated here.
          cartjson = JSON.parse(sessionStorage.getItem("cartdb")); //getting the cartdata from the session storage
          // get product detials for each productid in cartjson
          for(var k = 0; k<cartjson.length; k++) {
            $http.jsonp('http://api.zappos.com/Product/'+cartjson[k].id+'?callback=JSON_CALLBACK&key=12c3302e49b9b40ab8a222d7cf79a69ad11ffd78&includes=["styles","description"]').success(function(data) {
              var txt = data;
              var obj = txt.product;
              //add the returned details in the necessary form
              for(var i=0;i<obj.length;i++) {
                var style = obj[i].styles;
                  var new_obj = {"pid":obj[i].productId, "name":obj[i].productName, "image":obj[i].defaultImageUrl,"price":style[0].price};
                  var price = parseFloat(style[0].price.replace(/\$/, ""));
                  $scope.totalcost = parseFloat($scope.totalcost)+parseFloat(price);
                  $scope.numofitems++;
                  $scope.description = obj[i].description;
                  jsobj.push(new_obj);
              }
              //populate the list of products to be displayed
              
            }).error(function(data, status, headers, config) {
              $scope.errorMessage = "PID=" + pid;
              //$scope.errorMessage = "No product matching this search found, error # " + status;
              alert($scope.errorMessage);
            });
          }
          $scope.listOfProducts = jsobj;
          
        };
        
        $scope.removeitem = function(delpid) {
          var cartnum = 0;
          if (sessionStorage.getItem("cartnum") > 0) {;
            cartnum = sessionStorage.getItem("cartnum");
          }
          cartnum--;
          sessionStorage.setItem("cartnum",cartnum);
          
          var cartpids = []; //all products in cart will be populated here.
          var newcartjson = [];
          cartpids = JSON.parse(sessionStorage.getItem("cartdb")); //getting the cartdata from the session storage
          for(var k = 0; k<cartpids.length; k++) {
            if (cartpids[k].id != delpid) {
              newcartjson.push(cartpids[k]);
            }
          }
          sessionStorage.setItem("cartdb", JSON.stringify(newcartjson))
          $scope.loadproductdetails();
        };
      }
    </script>
  </head>
  <body ng-controller="AngularController" ng-init="loadproductdetails()">
  <div width=100% style="background-color:lightgrey;">
  <br><center><font size="4"><b>Checkout Page</b></font></center><br>
  </div>
  <br>
  <div data-role="page">
  <div class="container">
  <div id="cbp-pgcontainer" class="cbp-pgcontainer">
<script type="text/javascript">
  var scity="";
  var szip="";
  var scountry="";
  var sstate = "";
  var saddress="";
  var addrchange="";
  var ajax_request_progress=0;
  var selectedShipId=0;
  var useAddressValidator = "[useAddressValidator]";
  var validShippingAddress = 0;
  var lastShippingAddress = "";

   function get_Element(i)
  {
    return document.getElementById(i) || document.getElementsByName(i).item(0);
  } 
  function addressValidatorContinue(type)
  {
      jQuery.modal.close();
      remove_overlay("billing_info");
      if (get_Element('sameAsBilling') != 'undefined' && get_Element('sameAsBilling') != null){
          var sameAsBilling = get_Element('sameAsBilling').checked;}
      else{
          var sameAsBilling = true;}
      if (!sameAsBilling)
          remove_overlay("shipping_info");
      validShippingAddress = 1;
      check_address(type);
  }

  function check_address2_pos(type)
  {
      if (jQuery("#hdnAddrressValidatorResult").val() == "1")
      {
          jQuery.modal.close();
          validShippingAddress = 1;
          check_address(type);
      }
      else
      {
          validShippingAddress = 0;
          jQuery("#divAddrressValidator").modal({containerCss:{borderWidth:"1px"}});
      }  
  }

  function closeAddressValidatorModal()
  {
      parent.jQuery.modal.close();
      if (get_Element('sameAsBilling') != 'undefined' && get_Element('sameAsBilling') != null){
          var sameAsBilling = get_Element('sameAsBilling').checked;}
      else{
          var sameAsBilling = true;}
      if (!sameAsBilling)
          remove_overlay("shipping_info");
  }

      function selectAddress(AddrressValidator_address1, AddrressValidator_address2, AddrressValidator_city, AddrressValidator_state, AddrressValidator_zip, AddrressValidator_type, AddressValidator_RDI)
      {
          jQuery.modal.close();
          getElementById_s(AddrressValidator_type + "_address").value = AddrressValidator_address1;
          getElementById_s(AddrressValidator_type + "_address2").value = AddrressValidator_address2;
          getElementById_s(AddrressValidator_type + "_city").value = AddrressValidator_city;
          getElementById_s(AddrressValidator_type + "_zip").value = AddrressValidator_zip;
          getElementById_s(AddrressValidator_type + "_state").value = AddrressValidator_state;
          remove_overlay("billing_info");
          if (get_Element('sameAsBilling') != 'undefined' && get_Element('sameAsBilling') != null){
              var sameAsBilling = get_Element('sameAsBilling').checked;}
          else{
              var sameAsBilling = true;}
          if (!sameAsBilling)
            remove_overlay("shipping_info");
          if (getElementById_s("shipping_addresstype") && AddressValidator_RDI != ""){
            if (AddressValidator_RDI == "R")
              getElementById_s("shipping_addresstype").value = "1";
            else
              getElementById_s("shipping_addresstype").value = "2";
          }
          check_address(AddrressValidator_type);
      }

      function initpage()
      {
          check_address('shipping');
    
          if (!document.billing.shipping_zip)
          {
              select_shipping(-1);
          }
          else 
          {
              if (document.billing.shipping_zip.value == '')
                  select_shipping(-1);
          }
    
      }
  
      function check_address(type)
      {
          isSubmitComplete = false;

          if (get_Element('sameAsBilling') != 'undefined' && get_Element('sameAsBilling') != null)
          {
              var sameAsBilling = get_Element('sameAsBilling').checked;
          }
          else
          {
              var sameAsBilling = true; 
              if (type == 'shipping')
                  type = 'billing';
          }

          if (type == '')
              if (sameAsBilling)
                  type = 'billing';
              else
                  type = 'shipping';
      
          if ((sameAsBilling && type == 'billing') || (!sameAsBilling && type == 'shipping') || (type == 'addresstype') || (type == 'InvalidCart') || (type == 'refresh'))
              check_address2(type);
      }

      function check_address2(type) 
      {
          var overlayAdded = false;
          var type2 = type;
          if (get_Element('sameAsBilling') != 'undefined' && get_Element('sameAsBilling') != null)
              var sameAsBilling = get_Element('sameAsBilling').checked;
          else
              var sameAsBilling = true;
    
          if (type2 == 'InvalidCart' || type2 == 'refresh' || type2 == 'addresstype')
              if (sameAsBilling)
                  type = 'billing';
              else
                  type = 'shipping';
      
          addrchange=0;

          if (jQuery('#' + type + '_address').val() != saddress) { saddress = escape(removeHTMLTags(jQuery('#' + type + '_address').val())); addrchange = 1; }
          if (jQuery('#' + type + '_state').val() != sstate) { sstate = escape(removeHTMLTags(jQuery('#' + type + '_state').val())); addrchange = 1; }
          if (jQuery('#' + type + '_city').val() != scity) { scity = escape(removeHTMLTags(jQuery('#' + type + '_city').val())); addrchange = 1; }
          if (jQuery('#' + type + '_country').val() != scountry) { scountry = escape(removeHTMLTags(jQuery('#' + type + '_country').val())); addrchange = 1; }
          if (jQuery('#' + type + '_zip').val() != szip || jQuery('#' + type + '_country').val() != 'US') { szip = escape(removeHTMLTags(jQuery('#' + type + '_zip').val())); addrchange = 1; }

          if (type2 == 'refresh' || type2 == 'addresstype') {addrchange=1;}

          if (((szip.length >= 1 && sstate.length >= 1 && scountry.length >= 1) || (scountry != 'US' && scountry.length >= 1)) && addrchange == 1 && ajax_request_progress == 0) {
              if (get_Element('sameAsBilling') != 'undefined' && get_Element('sameAsBilling') != null)
              {
                  if (get_Element('sameAsBilling').checked)
                  {
                      sameAsBilling = 1;
                  }
                  else
                  {
                      add_overlay("shipping_info",0)
                      overlayAdded = true;
                      sameAsBilling = 0;
                  }
              }
              else
              {
                  sameAsBilling = 1;
              }
      
              if (get_Element('sameAsBilling') != 'undefined' && get_Element('sameAsBilling') != null)
              {
                  var sFirstname  = escape(get_Element('shipping_firstname').value);
                  var sLastname = escape(get_Element('shipping_lastname').value);
                  var sCompany  = escape(get_Element('shipping_company').value);
                  var sPhone    = escape(get_Element('shipping_phone').value);
                  var sAddress  = escape(get_Element('shipping_address').value);
                  var sAddress2 = escape(get_Element('shipping_address2').value);
                  var sCity   = escape(get_Element('shipping_city').value);
                  var sState    = escape(get_Element('shipping_state').value);
                  var sCountry  = escape(get_Element('shipping_country').value);
                  var sZip    = escape(get_Element('shipping_zip').value);
              }
              else
              {
                  var sFirstname  = ' ';
                  var sLastname = ' ';
                  var sCompany  = ' ';
                  var sPhone    = ' ';
                  var sAddress  = ' ';
                  var sAddress2 = ' ';
                  var sCity   = ' ';
                  var sState    = ' ';
                  var sCountry  = ' ';
                  var sZip    = ' ';
              }
      
              var bFirstname  = escape(get_Element('billing_firstname').value);
              var bLastname = escape(get_Element('billing_lastname').value);
              var bCompany  = escape(get_Element('billing_company').value);
              var bPhone    = escape(get_Element('billing_phone').value);
              var bAddress  = escape(get_Element('billing_address').value);
              var bAddress2 = escape(get_Element('billing_address2').value);
              var bCity   = escape(get_Element('billing_city').value);
              var bState    = escape(get_Element('billing_state').value);
              var bCountry  = escape(get_Element('billing_country').value);
              var bZip    = escape(get_Element('billing_zip').value);
              var sAddressType = '';

              if (get_Element('shipping_addresstype') != 'undefined' && get_Element('shipping_addresstype') != 'null' && get_Element('shipping_addresstype') != null)
                  sAddressType = escape(get_Element('shipping_addresstype').value);
        
              var myCountry = "US";
                myCountry = jQuery('#' + type + '_country').val();
                if (useAddressValidator == "1" && myCountry == "US"){
                    getElementById_s("hdnAddrressValidatorResult").value = "";
                    var url = 'addressvalidator.asp?no-cache='+Math.random();
                    var params = 'doaction=verify&ct=single&at='+type;
                    params += '&callBack=check_address2_pos(\''+type+'\');';
                    params += '&name=' + escape(getElementById_s(type + "_firstname").value + ' ' + getElementById_s(type + "_lastname").value);
                    if (getElementById_s(type + "_company")) params += '&company=' + escape(getElementById_s(type + "_company").value);
                    params += '&address=' + escape(getElementById_s(type + "_address").value);
                    params += '&address2=' + escape(getElementById_s(type + "_address2").value);
                    params += '&city=' + escape(getElementById_s(type + "_city").value);
                    params += '&state=' + escape(getElementById_s(type + "_state").value);
                    params += '&zip=' + escape(getElementById_s(type + "_zip").value);

                    
                    if ((params != lastShippingAddress || validShippingAddress == 0) && getElementById_s(type + "_address").value != "")
                    {
                        lastShippingAddress = params;
                        jQuery.ajax({
                            url: url,
                            dataType: 'html',
                            type: 'POST',
                            data: params,
                            cache: false,
                            success: function (strResult) {
                                jQuery("#divAddrressValidator").html(strResult);
                            },
                            error: reportError
                        }); 

                        if (overlayAdded)
                            remove_overlay("shipping_info");
                         
                        return false;
                    }
                }
                else
                {
                    validShippingAddress = 1;
                }


              if (get_Element(type+'_email'))
                  get_Element(type+'_email').focus();
              else
                  get_Element(type+'_state').focus();


              var url = 'ship_ajax.asp?no-cache='+Math.random();
              var params = 'shipping_zip=' + szip + '&shipping_city=' + scity + '&shipping_state=' + sstate + '&shipping_country=' + scountry;
              params = params + '&sFirstname=' + sFirstname;
              params = params + '&sLastname=' + sLastname;
              params = params + '&sCompany=' + sCompany;
              params = params + '&sPhone=' + sPhone;
              params = params + '&sAddress=' + sAddress;
              params = params + '&sAddress2=' + sAddress2;
              params = params + '&sCity=' + sCity;
              params = params + '&sState=' + sState;
              params = params + '&sCountry=' + sCountry;
              params = params + '&sZip=' + sZip;
              params = params + '&bFirstname=' + bFirstname;
              params = params + '&bLastname=' + bLastname;
              params = params + '&bCompany=' + bCompany;
              params = params + '&bPhone=' + bPhone;
              params = params + '&bAddress=' + bAddress;
              params = params + '&bAddress2=' + bAddress2;
              params = params + '&bCity=' + bCity;
              params = params + '&bState=' + bState;
              params = params + '&bCountry=' + bCountry;
              params = params + '&bZip=' + bZip;
              params = params + '&sameAsBilling=' + sameAsBilling;
              params = params + '&Addresstype=' + sAddressType;

              var formArray = getValuesAsArray(document.billing);
              for (var prop in formArray) {
                  if (prop == "echoFreightOptions" || prop.toLowerCase().indexOf("collect") > 0) {
                      var value = formArray[prop];
                      value = escape(value);
                      params = params + '&' + prop + '=' + value;
                  }
              }

              jQuery.ajax({
                  url: url,
                  dataType: 'html',
                  type: 'POST',
                  data: params,
                  cache: false,
                  success: function (strResult) {
                      jQuery("#shipResult").html(strResult);
                  },
                  complete: function (strResult) {
                      updateajax(type2);
                  },
                  error: reportError
              });   
          }
      }
  
      function updateajax(request)
      {
          ajax_request_progress=0;
          remove_overlay("billing_info");
    
          if (get_Element('sameAsBilling') != 'undefined' && get_Element('sameAsBilling') != null)
              if (!document.billing.sameAsBilling.checked) 
                  remove_overlay("shipping_info");

          remove_overlay("shipping_div");
          remove_overlay("total_div");
          remove_overlay("divPayment");
      }
  
      function reportError(jqXHR, textStatus) {
          isSubmitComplete = false;
          ajax_request_progress=0;
          remove_overlay("billing_info");

          if (get_Element('sameAsBilling') != 'undefined' && get_Element('sameAsBilling') != null)
              if (!document.billing.sameAsBilling.checked) 
                  remove_overlay("shipping_info");
          if (jqXHR.status > 0)
          {
              alert("Error processing request " + jqXHR.status + " - " + jqXHR);
          }
      }

      function showHideShipping() {

          if (get_Element('sameAsBilling') != 'undefined' && get_Element('sameAsBilling') != null)
          {
              if (document.billing.sameAsBilling.checked) 
              {
                  add_overlay("shipping_info",0);
        
                  get_Element('shipping_firstname').value = '';
                  get_Element('shipping_lastname').value = '';
                  get_Element('shipping_company').value = '';
                  get_Element('shipping_phone').value = '';
                  get_Element('shipping_address').value = '';
                  get_Element('shipping_address2').value = '';
                  get_Element('shipping_city').value = '';
                  get_Element('shipping_zip').value = ''; 
                  get_Element('shipping_country').value = get_Element('billing_country').value;
                  populateState('shipping_state','shipping_country');   
                  get_Element('shipping_state').value   = get_Element('billing_state').value; 
              }
              else 
              {
                  remove_overlay("shipping_info");
        
                  if (get_Element('shipping_firstname').value != "[shipping_firstname]")
                  {
                      get_Element('shipping_firstname').value = get_Element('billing_firstname').value;
                      get_Element('shipping_lastname').value  = get_Element('billing_lastname').value;
                      get_Element('shipping_company').value = get_Element('billing_company').value;
                      get_Element('shipping_phone').value   = get_Element('billing_phone').value;
                      get_Element('shipping_address').value = get_Element('billing_address').value;
                      get_Element('shipping_address2').value  = get_Element('billing_address2').value;
                      get_Element('shipping_city').value    = get_Element('billing_city').value;
                      get_Element('shipping_zip').value   = get_Element('billing_zip').value; 
                      get_Element('shipping_country').value = get_Element('billing_country').value;
                      populateState('shipping_state','shipping_country');
                      get_Element('shipping_state').value   = get_Element('billing_state').value;
                  }
              }
          }
      }

      function remove_overlay(panel)
      {
          var objBody = getElementById_s('overlay_'+panel);
          if (objBody != null && objBody != 'null' && objBody != undefined && objBody != 'undefined')
              objBody.style.display = 'none';
      }

      function add_overlay(panel,loading)
      {
          var objBody = getElementById_s(panel);
          var objOverlay = document.createElement("div");
    
          objOverlay.setAttribute('id','overlay_'+panel); 
          objOverlay.className='overlay';
          objOverlay.style.position = 'absolute';
          objOverlay.style.textAlign = 'center';
          objOverlay.style.width = objBody.clientWidth+"px";
          objOverlay.style.height = objBody.clientHeight+"px";
          //alert(objOverlay.style.height);
          objBody.insertBefore(objOverlay, objBody.firstChild);
          objOverlay.style.display = 'block';
   
          if (loading==1)
          {
              get_Element('overlay_'+panel).innerHTML = '<table border=0 width=100% height=100%><tr><td style="text-align: center;"><img src="assets/templates/common/images/loading.gif"></td></tr></table>';
          }
          else
          {
              get_Element('overlay_'+panel).innerHTML = '<table border=0 width=100% height=100%><tr><td align="center"></td></tr></table>';
          }
          DisableEnableForm(document.billing,false);
      }   

      function DisableEnableForm(xForm,xHow)
      {
          objElems = xForm.elements;
          for(i=0;i<objElems.length;i++)
          {
              objElems[i].disabled = xHow;
          } 
      }
  

      function fillEmailDiv()
      {
          var strValue = get_Element('billing_email').value;
          if (strValue == '')
              strValue = 'Type your email above';
          if (get_Element('divEmail') != 'undefined' && get_Element('divEmail') != null)
          {
              strValue = "&nbsp;" + jQuery.trim(removeHTMLTags(strValue));
              get_Element('divEmail').innerHTML = strValue;
          }
      }
  
  
      function removeHTMLTags(strString)
      {
          var strInputCode = strString;
      
          strInputCode = strInputCode.replace(/&(lt|gt);/g, function (strMatch, p1){
              return (p1 == "lt")? "<" : ">";
          });
          var strTagStrippedText = strInputCode.replace(/<\/?[^>]+(>|$)/g, "");
          strTagStrippedText = strTagStrippedText.replace(/\u00a0/g,'');
          //strTagStrippedText = strTagStrippedText.replace(/&nbsp;/gi,'');
          return strTagStrippedText;
      }
  
      addLoadEvent(initpage);
  
</script>
<center>
  <form action="checkout.html" method="post" name="billing" id="billing">
    <div id="billing_div" style="width:100%;">
      <table width="98%" cellpadding="0" cellspacing="6" border="0">
        <tr>
          <td colspan="2"><div id="divCart" style="width:100%;"> 
              <!--START: SHOPPING_CART_TEMP-->
              <table cellpadding="0" cellspacing="0" border="0" width="100%">
                <!--START: CATEGORY_HEADER-->
                <tr>
                  <td height="10" colspan="5"><table width="100%" cellspacing="0" cellpadding="2" border="0">
                    </table></td>
                </tr>
                <tr>
                  <td height="10" colspan="5"><img src="assets/templates/common/images/spacer.gif" alt="" width="1" height="10" /></td>
                </tr>
                <!--END: CATEGORY_HEADER-->

                <!--START: SHOPPING_CART_ITEM-->
                <tr>

                <center>
                <font size="4"><b>
                <pre>Number of Items: {{numofitems}}       </pre>
                <pre>Total Cost: ${{totalcost}}       </pre>
                </b>
                </font>
                </center>

                </tr>
 
                <!--END: SHOPPING_CART_ITEM-->
              </table>
              
              <!--END: SHOPPING_CART_TEMP--> 
            </div></td>
        </tr>
        <tr>
          <td colspan="2">&nbsp;</td>
        </tr>
        <tr> 
          <!-- start left bar-->
          <td valign="top" width="50%"><table width="100%" cellpadding="0" cellspacing="0">
              <tr>
                <td colspan="2" class="checkout-headers"> Billing Information </td>
              </tr>
              <tr>
                <td><div id="billing_info" style="width:100%">
                    <table width="100%" cellpadding="0" cellspacing="0">
                      <tr>
                        <td>
                            <div id="billing_info2" style="width:100%">
                            <table width="100%" cellpadding="0" cellspacing="4" class="alternative">
                            <tr>
                              <td width="31%" align="right" class="item"><b>First Name</b></td>
                              <td nowrap><input name="billing_firstname" type="text" id="billing_firstname" value="" size="15" class="txtBoxStyle"></td>
                            </tr>
                            <tr>
                              <td align="right" class="item"><b>Last Name </b></td>
                              <td nowrap><input name="billing_lastname" type="text" onChange="clearContent(this);" id="billing_lastname" value="" size="15" class="txtBoxStyle">
                                <!--START: req_billing_lastname--> 
                                <img src="images/error2.gif" width="12" height="12"> 
                                <!--END: req_billing_lastname--></td>
                            </tr>
                            <tr>
                              <td align="right" class="item"><b>Phone Number</b></td>
                              <td nowrap><input name="billing_phone" type="text" onChange="clearContent(this);" id="billing_phone" value="" size="15" class="txtBoxStyle">
                                <!--START: req_billing_phone--> 
                                <img src="images/error2.gif" width="12" height="12"> 
                                <!--END: req_billing_phone--></td>
                            </tr>
                            <tr>
                              <td align="right" class="item"><b>Address Line 1</b></td>
                              <td nowrap><input name="billing_address" type="text" onChange="clearContent(this);[po_box_disabled_billing]" id="billing_address" value="" size="25" class="txtBoxStyle">
                                <!--START: req_billing_address--> 
                                <img src="images/error2.gif" width="12" height="12"> 
                                <!--END: req_billing_address--></td>
                            </tr>
                            <tr>
                              <td align="right" class="item"><b>Address Line 2</b></td>
                              <td><input name="billing_address2" type="text" onChange="clearContent(this);" id="billing_address2" value="" size="25" class="txtBoxStyle"></td>
                            </tr>
                            <tr>
                              <td align="right" class="item"><b>City</b></td>
                              <td nowrap><input name="billing_city" type="text" onChange="clearContent(this);" id="billing_city" value="" size="25" class="txtBoxStyle">
                                
                                <!--START: req_billing_city--> 
                                <img src="images/error2.gif" width="12" height="12"> 
                                <!--END: req_billing_city--></td>
                            </tr>
                            <tr>
                              <td align="right" class="item"><b>Country</b></td>
                              <td nowrap><input name="biling_country" onChange="clearContent(this);" type="text" id="billing_country" value="" size="25" class="txtBoxStyle">
                                <!--START: req_billing_country--> 
                                <img src="images/error2.gif" width="12" height="12"> 
                                <!--END: req_billing_country--></td>
                            </tr>                  
                            <tr>
                              <td align="right" class="item"><b>State</b></td>
                              <td nowrap><input name="billing_state" onChange="clearContent(this);" type="text" id="billing_state" value="" size="25" class="txtBoxStyle">
                                <!--START: req_billing_state--> 
                                <img src="images/error2.gif" width="12" height="12"> 
                                <!--END: req_billing_state--></td>
                            </tr>                                      
                            <tr>
                              <td align="right" class="item"><b>Zipcode</b></td>
                              <td nowrap><input name="billing_zip" maxlength="15" type="text" id="billing_zip" value="" size="10" class="txtBoxStyle" onChange="clearContent(this);check_address('billing');" >
                                
                                <!--START: req_billing_zip--> 
                                <img src="images/error2.gif" width="12" height="12"> 
                                <!--END: req_billing_zip--></td>
                            </tr>
                            <tr>
                              <td align="right" class="item"><b>Email</b></td>
                              <td nowrap><input name="billing_email" type="text" id="billing_email" maxlength="50" value="" size="25" class="txtBoxStyle">
                                
                                <!--START: emailrequired--> 
                                <!--START: req_email--> 
                                <img src="images/error2.gif" width="12" height="12"> 
                                <!--END: req_email--> 
                                <!--END: emailrequired--></td>
                            </tr>
                          </table>
                          <br />
                          </div></td>
                      </tr>
                      <tr>
                        <td><table width="100%" cellpadding="0" cellspacing="4" class="alternative">
                          </table>
                          <br /></td>
                      </tr>
                    </table>
                  </div></td>
              </tr>
            </table></td>
          <!-- end left bar--> 
          <td valign="top" align="right">         
            <table width="97%" cellpadding="0" cellspacing="0">
              <tr class="checkout-headers">
                <td class="checkout-headers">Shipping Information</td>
                <!--START: sameAsBilling1-->
<!--                <td class="checkout-headers" valign="middle" width="130"><input type="checkbox" value="ON" name="sameAsBilling" id="sameAsBilling" onClick="showHideShipping();check_address('');">
                  <span class="item">Please select if same as billing address</span></td> -->
                <!--END: sameAsBilling1--> 
              </tr>
              <tr>
                <td colspan="3" align="right"><div id="shipping_info" style="width:100%;">
                    <table width="100%" cellpadding="0" cellspacing="0">
                      <tr>
                        <td><!--START: sameAsBilling2-->
                          
                          <table width="100%" cellpadding="0" cellspacing="4" class="alternative">
                            <tr>
                              <td width="30%" align="right" class="item"><b>First Name</b></td>
                              <td><input name="shipping_firstname" onChange="clearContent(this);" type="text" id="shipping_firstname" value="" size="15" class="txtBoxStyle">
                                <!--START: req_shipping_firstname--> 
                                <img src="images/error2.gif" width="12" height="12"> 
                                <!--END: req_shipping_firstname--></td>
                            </tr>
                            <tr>
                              <td align="right" class="item"><b>Last Name</b></td>
                              <td><input name="shipping_lastname" onChange="clearContent(this);" type="text" id="shipping_lastname" value="" size="15" class="txtBoxStyle">
                                <!--START: req_shipping_lastname--> 
                                <img src="images/error2.gif" width="12" height="12"> 
                                <!--END: req_shipping_lastname--></td>
                            </tr>
                            <tr>
                              <td align="right" class="item"><b>Phone Number</b></td>
                              <td nowrap><input name="shipping_phone" onChange="clearContent(this);" type="text" id="shipping_phone" value="" size="25" class="txtBoxStyle">
                                <!--START: req_shipping_phone--> 
                                <img src="images/error2.gif" width="12" height="12"> 
                                <!--END: req_shipping_phone--></td>
                            </tr>
                            <tr>
                              <td align="right" class="item"><b>Address Line 1</b></td>
                              <td nowrap><input name="shipping_address" onChange="clearContent(this)" type="text" id="shipping_address" value="" size="25" class="txtBoxStyle">
                                <!--START: req_shipping_address--> 
                                <img src="images/error2.gif" width="12" height="12"> 
                                <!--END: req_shipping_address--></td>
                            </tr>
                            <tr>
                              <td align="right" class="item"><b>Address Line 2</b></td>
                              <td nowrap><input name="shipping_address2" onChange="clearContent(this);" type="text" id="shipping_address2" value="" size="25" class="txtBoxStyle"></td>
                            </tr>
                            <tr>
                              <td align="right" class="item"><b>City</b></td>
                              <td nowrap><input name="shipping_city" onChange="clearContent(this);" type="text" id="shipping_city" value="" size="25" class="txtBoxStyle">
                                <!--START: req_shipping_city--> 
                                <img src="images/error2.gif" width="12" height="12"> 
                                <!--END: req_shipping_city--></td>
                            </tr>
                            <tr>
                              <td align="right" class="item"><b>Country</b></td>
                              <td nowrap><input name="shipping_country" onChange="clearContent(this);" type="text" id="shipping_country" value="" size="25" class="txtBoxStyle">
                                <!--START: req_shipping_country--> 
                                <img src="images/error2.gif" width="12" height="12"> 
                                <!--END: req_shipping_country--></td>
                            </tr>
                            <tr>
                              <td align="right" class="item"><b>State</b></td>
                              <td nowrap><input name="shipping_state" onChange="clearContent(this);" type="text" id="shipping_state" value="" size="25" class="txtBoxStyle">
                                <!--START: req_shipping_state--> 
                                <img src="images/error2.gif" width="12" height="12"> 
                                <!--END: req_shipping_state--></td>
                            </tr>
                            <tr>
                              <td align="right" class="item"><b>Zipcode</b></td>
                              <td nowrap><input name="shipping_zip" maxlength="15" type="text" id="shipping_zip" value="" size="10" class="txtBoxStyle" onChange="clearContent(this);" >
                                <!--START: req_shipping_zip--> 
                                <img src="images/error2.gif" width="12" height="12"> 
                                <!--END: req_shipping_zip--></td>
                            </tr>
                          </table>
                          <!--END: sameAsBilling2--> 
                          <br /></td>
                      </tr>
                    </table>
                  </div></td>
              </tr>
            </table></td>
          <!-- end right bar--> 
        </tr>
        <tr> 
          <!-- start right bar2-->
          <td valign="top" align="center"><table width="95%" cellpadding="0" cellspacing="0">
              <tr>
                <td colspan="3"><div id="total_div" name="total_div" style="width:100%;"> 

                    <!--START: total_template-->
                    <center><table width="100%" cellpadding="0" cellspacing="2" id="Table20" border="0" class="alternative">
                      <tr>
                        <td class="item"><strong>Cost of Items</strong>:</td>
                        <td class="item" style="text-align:right;">${{totalcost}}</td>
                      </tr>
                     <tr>
                        <td class="item" ><strong>Shipping Cost</strong>:</td>
                        <td class="item" style="text-align:right;">$0.00</td>
                      </tr>
                      <tr>
                        <td class="item"><strong>Taxes</strong>:</td>
                        <td class="item" style="text-align:right;">$0.00</td>
                      </tr>
                      <tr>
                        <td class="item" colspan="2"><hr></td>
                      </tr>
                      <tr>
                        <td class="item"><strong>Total Balance</strong>:</td>
                        <td class="item" style="text-align:right;"><span class="price">${{totalcost}}</span></td>
                      </tr>
                      <tr>
                        <td class="item" colspan="2"><hr></td>
                      </tr>
                    </table></center>
                    <!--END: total_template--> 
                  </div></td>
              </tr>
            </table></td>
          <!-- end right bar2--> 
        </tr>
        <tr>
          <td colspan="2"><div id="divPayment" style="width:100%"> 

            <br />
              <tr>
                <td align="right">
                    <a name="checkoutButton">                    
                    <button type="button" onclick="alert('All Items Checked Out')">Check Out</button>
              </tr>
            </table></td>
        </tr>
        <tr>

            
            <!--END: CATEGORY_FOOTER--></td>
        </tr>
      </table>
    </div>
  </form>
  <script>
  window.setTimeout('showHideShipping_init()',100);

  function showHideShipping_init()
  {
    var objBody = getElementById_s('shipping_info');  
    var intWidth = objBody.clientWidth;
    if (intWidth == 0)
      window.setTimeout('showHideShipping_init()',100);
    else
      showHideShipping();
  }
  
  initCountry('[billing_country]','[billing_state_script]','billing_state','billing_country');
  if (get_Element('shipping_state') != 'undefined' && get_Element('shipping_state') != null)
    initCountry('[shipping_country]','[shipping_state_script]','shipping_state','shipping_country');
  
  //Every time that there's no state for a selected country, that script deletes the state control and creates another one.
  //That's why we need to re-create the validation for the state.
  var billingStateType = document.billing.billing_state.type;
  if (get_Element('sameAsBilling') != 'undefined' && get_Element('sameAsBilling') != null)
    var shippingStateType = document.billing.shipping_state.type;
  
  function check_stateValidator(type)
  {
    if (type == 'billing')
    {
      if (document.billing.billing_state.type != billingStateType)
      {
        frmvalidator.addValidation("billing_state","req","Please enter/select your billing state");
        frmvalidator.addValidation("billing_state","maxlen=50");
        billingStateType = document.billing.billing_state.type;
      }
    }
    else
    {
      if (document.billing.shipping_state.type != shippingStateType)
      {
        frmvalidator.addValidation("shipping_state","req","Please enter/select your shipping state");
        frmvalidator.addValidation("shipping_state","maxlen=50");
        shippingStateType = document.billing.shipping_state.type;
      }   
    }
  }

  function setValidation()
  {
    frmvalidator.clearAllValidations();
    
    frmvalidator.addValidation("billing_firstname","req","Please enter your billing First Name");
    frmvalidator.addValidation("billing_firstname","maxlen=20","Max length for billing First Name is 20");

    frmvalidator.addValidation("billing_lastname","req","Please enter your billing Last Name");
    frmvalidator.addValidation("billing_lastname","maxlen=20","Max length for billing Last Name is 20");

    <!--START: phonerequiredscript-->
    frmvalidator.addValidation("billing_phone","maxlen=18","Max length for billing Phone is 18");
        if (get_Element('billing_country') != 'undefined' && get_Element('billing_country') != null)
            if (get_Element('billing_country').value == "US")
            frmvalidator.addValidation("billing_phone","phone","Invalid phone number.");
    frmvalidator.addValidation("billing_phone","req","Please enter your billing phone")
    <!--END: phonerequiredscript-->

    frmvalidator.addValidation("billing_address","maxlen=50");
    frmvalidator.addValidation("billing_address","req","Please enter your billing address");

    frmvalidator.addValidation("billing_city","maxlen=50");
    frmvalidator.addValidation("billing_city","req","Please enter your billing city");

        if (get_Element('billing_country').value == "US")
        {
        frmvalidator.addValidation("billing_state","req","Please enter/select your billing state");
        frmvalidator.addValidation("billing_state","maxlen=50");
        }

    frmvalidator.addValidation("billing_zip","maxlen=15");
    frmvalidator.addValidation("billing_zip","req","Please enter your billing zip code");
    
    <!--START: emailrequiredscript-->
    frmvalidator.addValidation("billing_email","maxlen=50","Max length for Email is 50");
    frmvalidator.addValidation("billing_email","req","Please enter your email address");
    frmvalidator.addValidation("billing_email","email");    
    <!--END: emailrequiredscript-->
    
    <!--START: confirmemailscript-->
    if (document.billing.billing_confirmemail != null && document.billing.billing_confirmemail != 'undefined')
    {
      frmvalidator.addValidation("billing_confirmemail","maxlen=50","Max length for Email is 50");
      frmvalidator.addValidation("billing_confirmemail","req","Please confirm your Email.");
      frmvalidator.addValidation("billing_confirmemail","email","Please confirm your Email.");
      frmvalidator.setAddnlValidationFunction("confirmationValidation");
    }
    <!--END: confirmemailscript-->

    <!--START: passwordrequiredscript-->
    frmvalidator.addValidation("pass","maxlen=20");
    frmvalidator.addValidation("pass","req","Please enter your new password (registration is required)");
    <!--END: passwordrequiredscript-->
        
    frmvalidator.addValidation("billing_country","dontselect=0");
        
    if (get_Element('sameAsBilling') != 'undefined' && get_Element('sameAsBilling') != null)
      if (!document.billing.sameAsBilling.checked)
      {
        frmvalidator.addValidation("shipping_firstname","req","Please enter your shipping First Name");
        frmvalidator.addValidation("shipping_firstname","maxlen=20","Max length for shipping First Name is 20");

        frmvalidator.addValidation("shipping_lastname","req","Please enter your shipping Last Name");
        frmvalidator.addValidation("shipping_lastname","maxlen=20","Max length for shipping Last Name is 20");
        <!--START: phonerequiredscript-->
        frmvalidator.addValidation("shipping_phone","maxlen=18","Max length for shipping Phone is 18");
                if (get_Element('shipping_country') != 'undefined' && get_Element('shipping_country') != null)
                    if (get_Element('shipping_country').value == "US")
                    frmvalidator.addValidation("shipping_phone","phone","Invalid phone number.");
        frmvalidator.addValidation("shipping_phone","req","Please enter your shipping phone")
        <!--END: phonerequiredscript-->
        frmvalidator.addValidation("shipping_address","maxlen=50");
        frmvalidator.addValidation("shipping_address","req","Please enter your shipping address");

        frmvalidator.addValidation("shipping_city","maxlen=50");
        frmvalidator.addValidation("shipping_city","req","Please enter your shipping city");

                if (get_Element('shipping_country').value == "US")
                {
            frmvalidator.addValidation("shipping_state","req","Please enter/select your shipping state");
            frmvalidator.addValidation("shipping_state","maxlen=50");
                }

        frmvalidator.addValidation("shipping_zip","maxlen=15");
        frmvalidator.addValidation("shipping_zip","req","Please enter your shipping zip code");

        frmvalidator.addValidation("shipping_country","dontselect=0");    
      }
      
  }
</script> 
<script type="text/javascript">
var frmvalidator = new Validator("billing");
frmvalidator.EnableMsgsTogether();

function confirmationValidation()
{
    if(get_Element("billing_email").value != get_Element("billing_confirmemail").value)
    {
        alert('The Email does not match.');
        return false;
    }
    return true;
}
</script>     
  </ul>
  </div>
  </div>
  </div>
</body>